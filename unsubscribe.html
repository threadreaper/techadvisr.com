<!DOCTYPE html>
<html lang="en">
	<head>
		<meta charset="utf-8" />
		<link href="https://fonts.gstatic.com" rel="preconnect dns-prefetch" />
		<title>Techadvisr.com - Unsubscribe</title>
		<link href="https://www.techadvisr.com/css/flux.min.css" rel="stylesheet" type="text/css" />
		<link href="https://www.techadvisr.com/css/style.min.css" rel="stylesheet" type="text/css" />
		<script async src="https://www.techadvisr.com/js/lazysizes.min.js"></script>
		<link href="https://fonts.googleapis.com/css2?family=Lato:wght@400;700&family=Montserrat:wght@400;500;600;700;800;900&display=swap" rel="stylesheet" />
	</head>
	<body>
		<iframe src="header.html"
		onload="this.before(this.contentDocument.children[0]);this.remove()"></iframe>
			<div class="wrapper col" style="height: 63vh">
				<h2>Hey, We Get It...</h2>
				<br />
				<span class="subtitle-2"
					>You won't hear from us any more. But we're always here if
					you need us!</span
				><br />
				Just enter your email address and click the "Unsubscribe" button
				below to be removed from our mailing list.
				<form name="submit-form-to-google-sheets">
					<div class="text-input-container">
						<input
							aria-required="”true”"
							class="text-input"
							id="email"
							name="damnYouChrome"
							required=""
							type="email"
						/>
						<label for="email">E-mail Address</label>
						<span class="focus-border"><i></i></span>
					</div>

					<input
						type="hidden"
						name="unsubscribe"
						id="unsubscribe"
						value="true"
					/>

					<button type="submit" class="unsubscribe">
						<div class="text">Unsubscribe</div>
						<div class="loader"></div>
						<div class="done">
							<svg
								id="checkmark"
								data-name="checkmark"
								xmlns="http://www.w3.org/2000/svg"
								viewBox="0 0 73.8 73.8"
							>
								<filter id="shadow">
									<feDropShadow
										dx="0.5"
										dy="0.5"
										stdDeviation="0.5"
									/>
								</filter>
								<g
									id="check-group"
									stroke="none"
									stroke-width="1"
									fill="none"
									fill-rule="evenodd"
								>
									<polygon
										id="check"
										fill="#f2f2f2"
										points="30.29 53.81 17.33 40.85 23.42 34.77 30.29 41.64 50.38 21.54 56.47 27.63 30.29 53.81"
									/>
								</g>
							</svg>
						</div>
					</button>
				</form>
				<div class="responseDiv" style="width: 185px"></div>
			</div>
			<iframe
				src="footer.html"
				onload="this.before(this.contentDocument.children[0]);this.remove()"
			></iframe>
		<script src="https://www.techadvisr.com/js/flux.js"></script>
		<script src="https://wzrd.in/standalone/formdata-polyfill"></script>
		<script src="https://wzrd.in/standalone/promise-polyfill@latest"></script>
		<script src="https://wzrd.in/standalone/whatwg-fetch@latest"></script>
		<script>
			const qS = document.querySelector.bind(document),
				done = qS(".done"),
				email = qS("#email"),
				loader = qS(".loader"),
				responseDiv = qS(".responseDiv"),
				text = qS(".text"),
				unsub = qS(".unsubscribe"),
				scriptURL =
					"https://script.google.com/macros/s/AKfycbwfkNaqguVNUZvJ7EbuER7K9LH9_xtmj5e6rQ2uOUOVXmI-qelb/exec",
				form = document.forms["submit-form-to-google-sheets"];

			form.addEventListener("submit", function (e) {
				e.preventDefault();

				unsub.disabled = true;

				loader.classList.add("active");
				text.classList.add("active");
				unsub.classList.add("active");

				fetch(scriptURL, {
					method: "POST",
					body: new FormData(form),
				})
					.then((response) => {
						console.log(response.text());
						unsub.classList.add("finished");
						unsub.classList.remove("active");
						loader.classList.remove("active");
						done.classList.add("active");
						responseDiv.innerHTML =
							email.value + " successfully unsubscribed.";
					})
					.catch((error) => console.error("Error!", error.message));
			});
		</script>
	</body>
</html>
